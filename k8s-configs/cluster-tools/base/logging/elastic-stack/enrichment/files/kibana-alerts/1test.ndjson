{
   "name": "test",
   "type": "monitor",
   "monitor_type": "bucket_level_monitor",
   "enabled": true,
   "schedule": {
      "period": {
         "unit": "MINUTES",
         "interval": 1
      }
   },
   "inputs": [
      {
         "search": {
            "indices": [
               "1test-2023.04.05-000001"
            ],
            "query": {
               "query": {
                  "bool": {
                     "filter": [
                        {
                           "match_all": {
                              "boost": 1
                           }
                        },
                        {
                           "match_phrase": {
                              "kubernetes.labels.role": {
                                 "query": "pingfederate-engine",
                                 "slop": 0,
                                 "zero_terms_query": "NONE",
                                 "boost": 1
                              }
                           }
                        },
                        {
                           "match_phrase": {
                              "message": {
                                 "query": "Exception",
                                 "slop": 0,
                                 "zero_terms_query": "NONE",
                                 "boost": 1
                              }
                           }
                        },
                        {
                           "match_phrase": {
                              "className": {
                                 "query": "\"org.sourceid.saml20.proles.idp.HandleAuthnRequest\"",
                                 "slop": 0,
                                 "zero_terms_query": "NONE",
                                 "boost": 1
                              }
                           }
                        },
                        {
                           "range": {
                              "@timestamp": {
                                 "from": "now-5m",
                                 "to": "now",
                                 "include_lower": true,
                                 "include_upper": true,
                                 "format": "strict_date_optional_time",
                                 "boost": 1
                              }
                           }
                        }
                     ],
                     "adjust_pure_negative": true,
                     "boost": 1
                  }
               },
               "aggregations": {
                  "composite_agg": {
                     "composite": {
                        "size": 10,
                        "sources": [
                           {
                              "cluster_name": {
                                 "terms": {
                                    "field": "cluster_name.keyword",
                                    "missing_bucket": false,
                                    "order": "asc"
                                 }
                              }
                           }
                        ]
                     }
                  }
               }
            }
         }
      }
   ],
   "triggers": [
      {
         "bucket_level_trigger": {
            "id": "IVbCTIcBLHqNmr4MvAQw",
            "name": "SSM",
            "severity": "1",
            "condition": {
               "buckets_path": {
                  "_count": "_count"
               },
               "parent_bucket_path": "composite_agg",
               "script": {
                  "source": "params._count > 1",
                  "lang": "painless"
               },
               "gap_policy": "skip"
            },
            "actions": []
         }
      }
   ],
   "ui_metadata": {
      "schedule": {
         "timezone": null,
         "frequency": "interval",
         "period": {
            "unit": "MINUTES",
            "interval": 1
         },
         "daily": 0,
         "weekly": {
            "tue": false,
            "wed": false,
            "thur": false,
            "sat": false,
            "fri": false,
            "mon": false,
            "sun": false
         },
         "monthly": {
            "type": "day",
            "day": 1
         },
         "cronExpression": "0 */1 * * *"
      },
      "monitor_type": "bucket_level_monitor",
      "search": {
         "searchType": "query",
         "timeField": "@timestamp",
         "aggregations": [],
         "groupBy": [
            "@version"
         ],
         "bucketValue": 1,
         "bucketUnitOfTime": "h",
         "where": {
            "fieldName": [],
            "fieldRangeEnd": 0,
            "fieldRangeStart": 0,
            "fieldValue": "",
            "operator": "is"
         }
      }
   }
}